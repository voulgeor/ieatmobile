import{_ as D,n,p as g,q as d,t as u,u as l,k as a,R as i,aj as V,V as c,a9 as h,ab as f,X as p,ad as b,S as y,U as S,F as k,a3 as U,ac as v,bM as B,ae as E,aa as O}from"./index.e230319b.js";import{Q}from"./QToolbarTitle.259c42a1.js";import{Q as j}from"./QToolbar.6df38dcd.js";import{Q as T}from"./QPopupEdit.c17f3aea.js";import{Q as M}from"./QSpace.e9701f98.js";import{Q as I}from"./QSelect.e624ffdf.js";import{Q as N}from"./QBtnToggle.2ee9a314.js";import{Q as z}from"./QFooter.10036f87.js";import{Q as R}from"./QForm.014ed36c.js";import{C as A}from"./ClosePopup.1d195224.js";import{F as G,f as K,k as P}from"./index.b0a8ca52.js";import{u as H}from"./MapStore.6b25f224.js";import"./QChip.cd74be9a.js";import"./QItemLabel.a48bebab.js";import"./selection.69ceab22.js";import"./rtl.b51694b1.js";import"./format.2a3572e1.js";import"./QResizeObserver.14e0edf7.js";const L={name:"AddressDetails",props:["maps_config"],components:{GoogleMap:G,Marker:K,Circle:P},setup(){return{MapStore:H()}},data(){return{show_modal:!1,loading:!1,location_data:[],location_name:"",delivery_options:"",delivery_instructions:"",address_label:"$t('Home')",attributes:[],delivery_options_data:[],address_label_data:[],formatted_address:"",adjust_pin:!1,class_map:"map bg-grey-2 rounded-10 q-mb-md",marker:[],validat_coord:!1,new_lat:"",new_lng:"",center:[],marker_position:[],icon:{text:"\uEA44",fontFamily:"Material Icons",color:"#ffffff",fontSize:"18px"},circles:{}}},mounted(){this.addressAtttibues()},watch:{adjust_pin(e,o){e?this.class_map="window-height full-width":this.class_map="map bg-grey-2 rounded-10 q-mb-md"}},methods:{beforeShow(){this.adjust_pin=!1},showModal(){this.show_modal=!0;const e={lat:parseFloat(this.location_data.latitude),lng:parseFloat(this.location_data.longitude)};this.marker_position=e,this.center=e,this.new_lat=parseFloat(this.location_data.latitude),this.new_lng=parseFloat(this.location_data.longitude),this.location_data.attributes&&(this.location_name=this.location_data.attributes.location_name,this.delivery_options=this.location_data.attributes.delivery_options,this.delivery_instructions=this.location_data.attributes.delivery_instructions,this.address_label=this.location_data.attributes.address_label),this.circles.location={center:e,radius:250,strokeColor:"#f5b358",strokeOpacity:.1,strokeWeight:2,fillColor:"#f5b358",fillOpacity:.35}},closeModal(){this.show_modal=!1,this.adjust_pin=!1},addressAtttibues(){n.addressAtttibues().then(e=>{this.attributes=e.details,Object.keys(e.details.delivery_option).length>0&&Object.entries(e.details.delivery_option).forEach(([o,r])=>{this.delivery_options_data.push({label:r,value:o})}),Object.keys(e.details.address_label).length>0&&Object.entries(e.details.address_label).forEach(([o,r])=>{this.address_label_data.push({label:r,value:o})})}).catch(e=>{n.notify("dark",e,"error",this.$q)}).then(e=>{})},centerChanged(){if(this.adjust_pin){const o=this.$refs.mapRef.map.getCenter();this.marker_position={lat:o.lat(),lng:o.lng()},this.new_lat=o.lat(),this.new_lng=o.lng()}},validateCoordinates(){const e={lat:parseFloat(this.location_data.latitude),lng:parseFloat(this.location_data.longitude),new_lat:this.new_lat,new_lng:this.new_lng};this.loading=!0,n.validateCoordinates(e).then(o=>{this.adjust_pin=!1,this.location_data.latitude=this.new_lat,this.location_data.longitude=this.new_lng}).catch(o=>{n.notify("dark",o,"error",this.$q)}).then(o=>{this.loading=!1})},onSubmit(){console.debug("onSubmit"),this.loading=!0;const e={delivery_instructions:this.delivery_instructions,delivery_options:this.delivery_options,formatted_address:this.location_data.address.formatted_address,location_name:this.location_name,address_label:this.address_label,data:this.location_data};n.saveClientAddress(e).then(o=>{this.closeModal(),n.setStorage("place_id",o.details.place_id),this.$emit("afterSaveaddress")}).catch(o=>{n.notify("dark",o,"error",this.$q)}).then(o=>{this.loading=!1})}}},W={class:"col-12"},X={class:"row items-center items-stretch"},J={class:"col-9"},Y={class:"text-weight-bold"},Z={class:"cursor-pointer font12 text-grey"},x={class:"col-3"},$={class:"q-gutter-sm"},ee={class:"text-h6"},te={class:"fit relative-position"};function oe(e,o,r,_,t,m){const w=g("Marker"),q=g("Circle"),C=g("GoogleMap");return d(),u(O,{modelValue:t.show_modal,"onUpdate:modelValue":o[6]||(o[6]=s=>t.show_modal=s),persistent:"",onBeforeShow:m.beforeShow,maximized:!0,"transition-show":"fade","transition-hide":"fade"},{default:l(()=>[a(E,{class:"row items-stretch"},{default:l(()=>[i("div",W,[t.adjust_pin?b("",!0):(d(),u(j,{key:0},{default:l(()=>[V(a(c,{icon:"close",flat:"",round:"",dense:"",color:e.$q.dark.mode?"white":"dark"},null,8,["color"]),[[A]]),a(Q,{class:h(["text-weight-bold",{"text-white":e.$q.dark.mode,"text-dark":!e.$q.dark.mode}])},{default:l(()=>[f(p(e.$t("Delivery Address")),1)]),_:1},8,["class"])]),_:1})),i("div",{class:h({"q-pl-md q-pr-md":!t.adjust_pin,"fit ":t.adjust_pin})},[t.adjust_pin?(d(),y(k,{key:1},[i("div",te,[i("div",{class:h(["absolute-top-left full-width z-top",{"bg-dark":e.$q.dark.mode,"bg-white":!e.$q.dark.mode}])},[a(j,null,{default:l(()=>[V(a(c,{icon:"eva-close-outline",flat:"",round:"",dense:"",color:e.$q.dark.mode?"white":"dark"},null,8,["color"]),[[A]]),a(Q,{class:h(["text-weight-bold",{"text-white":e.$q.dark.mode,"text-dark":!e.$q.dark.mode}])},{default:l(()=>[f(p(e.$t("Delivery Address")),1)]),_:1},8,["class"])]),_:1})],2),a(C,{ref:"mapRef",class:"fit","api-key":r.maps_config.key,center:t.center,zoom:r.maps_config.zoom,"disable-default-ui":!0,onCenter_changed:m.centerChanged,onDragend:e.dragEnd,styles:e.$q.dark.mode?_.MapStore.map_style_dark:_.MapStore.map_style_light},{default:l(()=>[a(w,{options:{position:t.marker_position,label:t.icon}},null,8,["options"]),t.adjust_pin?(d(!0),y(k,{key:0},S(t.circles,s=>(d(),u(q,{key:s.center,options:s},null,8,["options"]))),128)):b("",!0)]),_:1},8,["api-key","center","zoom","onCenter_changed","onDragend","styles"])]),a(z,{class:"q-pl-md q-pr-md q-pt-sm q-pb-sm bg-white"},{default:l(()=>[a(c,{label:e.$t("Save"),loading:t.loading,onClick:m.validateCoordinates,unelevated:"","no-caps":"",color:"primary text-white",class:"full-width text-weight-bold",size:"lg"},null,8,["label","loading","onClick"])]),_:1})],64)):(d(),u(R,{key:0,onSubmit:m.onSubmit},{default:l(()=>[a(C,{ref:"mapRef",class:"map bg-grey-2 radius8 q-mb-md","api-key":r.maps_config.key,center:t.center,zoom:r.maps_config.zoom,"disable-default-ui":!0,onCenter_changed:m.centerChanged,onDragend:e.dragEnd,styles:e.$q.dark.mode?_.MapStore.map_style_dark:_.MapStore.map_style_light},{default:l(()=>[a(w,{options:{position:t.marker_position,label:t.icon}},null,8,["options"]),t.adjust_pin?(d(!0),y(k,{key:0},S(t.circles,s=>(d(),u(q,{key:s.center,options:s},null,8,["options"]))),128)):b("",!0)]),_:1},8,["api-key","center","zoom","onCenter_changed","onDragend","styles"]),i("div",X,[i("div",J,[i("div",Y,p(t.location_data.address.address1),1),i("div",Z,[f(p(t.location_data.address.formatted_address)+" ",1),a(U,{name:"eva-edit-outline"}),a(T,{modelValue:t.location_data.address.formatted_address,"onUpdate:modelValue":o[0]||(o[0]=s=>t.location_data.address.formatted_address=s),"auto-save":""},{default:l(s=>[a(v,{modelValue:s.value,"onUpdate:modelValue":F=>s.value=F,dense:"",autofocus:"",counter:"",onKeyup:B(s.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:1},8,["modelValue"])])]),i("div",x,[a(c,{onClick:o[1]||(o[1]=s=>t.adjust_pin=!t.adjust_pin),unelevated:"",color:e.$q.dark.mode?"grey600":"mygrey","text-color":e.$q.dark.mode?"grey300":"dark",icon:"las la-map-marker","no-caps":"",class:"line-normal fit"},null,8,["color","text-color"])])]),a(M,{class:"q-pa-sm"}),i("div",$,[a(v,{modelValue:t.location_name,"onUpdate:modelValue":o[2]||(o[2]=s=>t.location_name=s),label:e.$t("Aparment, suite or floor"),outlined:"","lazy-rules":"","bg-color":e.$q.dark.mode?"grey600":"input","label-color":e.$q.dark.mode?"grey300":"grey",borderless:"",class:"input-borderless"},null,8,["modelValue","label","bg-color","label-color"]),a(I,{modelValue:t.delivery_options,"onUpdate:modelValue":o[3]||(o[3]=s=>t.delivery_options=s),options:t.delivery_options_data,"transition-show":"fade","transition-hide":"fade","emit-value":"",outlined:"","lazy-rules":"","bg-color":e.$q.dark.mode?"grey600":"input","label-color":e.$q.dark.mode?"grey300":"grey",borderless:"",class:"input-borderless"},null,8,["modelValue","options","bg-color","label-color"]),a(v,{modelValue:t.delivery_instructions,"onUpdate:modelValue":o[4]||(o[4]=s=>t.delivery_instructions=s),autogrow:"",label:e.$t("Add delivery instructions"),outlined:"","lazy-rules":"","bg-color":e.$q.dark.mode?"grey600":"input","label-color":e.$q.dark.mode?"grey300":"grey",borderless:"",class:"input-borderless"},null,8,["modelValue","label","bg-color","label-color"]),i("div",ee,p(e.$t("Address label")),1),a(N,{modelValue:t.address_label,"onUpdate:modelValue":o[5]||(o[5]=s=>t.address_label=s),"toggle-color":"secondary",color:e.$q.dark.mode?"grey600":"mygrey","text-color":e.$q.dark.mode?"grey300":"dark","no-caps":"","no-wrap":"",unelevated:"",options:t.address_label_data,class:"rounded-group2 text-weight-bold line-1"},null,8,["modelValue","color","text-color","options"]),a(M,{class:"q-pa-xl"}),a(z,{class:"q-pl-md q-pr-md q-pt-sm q-pb-sm bg-white"},{default:l(()=>[a(c,{type:"submit",loading:t.loading,label:e.$t("Save Address"),unelevated:"","no-caps":"",color:"primary text-white",class:"full-width text-weight-bold",size:"lg"},null,8,["loading","label"])]),_:1})])]),_:1},8,["onSubmit"]))],2)])]),_:1})]),_:1},8,["modelValue","onBeforeShow"])}var ve=D(L,[["render",oe]]);export{ve as default};
