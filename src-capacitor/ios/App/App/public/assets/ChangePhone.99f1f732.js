import{_ as u,m as _,v as c,n as i,p as b,q as g,R as v,k as o,u as s,ad as y,a8 as x,aa as d,V as p,U as m,ae as V,Q as h,ab as Q,ar as w,b0 as C,bE as S,a9 as k,F as q}from"./index.f4219e68.js";import{Q as P}from"./QToolbarTitle.5cae28fa.js";import{Q as A}from"./QSpace.ac683136.js";import{Q as T}from"./QToolbar.9e0c5c2c.js";import{Q as E}from"./QSelect.ecc94997.js";import{Q as I}from"./QForm.bd9e2742.js";import"./QChip.1607d7b2.js";import"./QItemLabel.5e2891ed.js";import"./selection.babb8692.js";import"./rtl.4b414a6d.js";import"./format.2a3572e1.js";const $={name:"ChangePhone",props:["prefixes","phone_prefix_orig","contact_number_orig"],components:{StepsVerification:_(()=>c(()=>import("./StepsVerification.9d6b4b40.js"),["assets/StepsVerification.9d6b4b40.js","assets/QSpace.ac683136.js","assets/index.f4219e68.js","assets/index.f7829e99.css","assets/QToolbar.9e0c5c2c.js","assets/QForm.bd9e2742.js","assets/QInnerLoading.1e0d2bac.js"]))},data(){return{show_modal:!1,loading:!1,phone_prefix:"",phone_number:"",sent_message:""}},computed:{hasChangePhone(){return!(this.phone_prefix_orig!==this.phone_prefix||this.contact_number_orig!==this.phone_number)}},updated(){i.empty(this.phone_prefix)&&(this.phone_prefix=this.phone_prefix_orig),i.empty(this.phone_number)&&(this.phone_number=this.contact_number_orig)},watch:{phone_prefix_orig(e,t){this.phone_prefix=e},contact_number_orig(e,t){this.phone_number=e}},methods:{showModal(e){this.show_modal=e},beforeSubmit(){this.loading=!0,i.RequestEmailCode().then(e=>{this.sent_message=e.msg,this.show_modal=!1,this.$refs.steps_verification.show_modal=!0}).catch(e=>{i.notify("grey-8",e,"error_outline",this.$q)}).then(e=>{this.loading=!1})},afterVerifycode(e){this.$refs.steps_verification.visible=!0;const t={code:e,phone_prefix:this.phone_prefix,phone_number:this.phone_number,cart_uuid:i.getStorage("cart_uuid")};i.ChangePhone(t).then(a=>{this.$refs.steps_verification.show_modal=!1,i.notify("dark",a.msg,"done",this.$q),this.$emit("afterChangephone",a.details)}).catch(a=>{i.notify("dark",a,"error",this.$q)}).then(a=>{this.$refs.steps_verification.visible=!1})}}},z={class:"font12"},B={class:"radius8 q-pa-sm border-grey"};function N(e,t,a,U,r,l){const f=b("StepsVerification");return g(),v(q,null,[o(k,{modelValue:r.show_modal,"onUpdate:modelValue":t[3]||(t[3]=n=>r.show_modal=n),position:"bottom"},{default:s(()=>[o(y,null,{default:s(()=>[o(T,{class:"text-primary top-toolbar q-pl-md",dense:""},{default:s(()=>[o(P,{class:x(["text-weight-bold",{"text-white":e.$q.dark.mode,"text-dark":!e.$q.dark.mode}])},{default:s(()=>[d(p(e.$t("Your phone number")),1)]),_:1},8,["class"]),o(A),o(m,{onClick:t[0]||(t[0]=n=>r.show_modal=!1),color:"white",square:"",unelevated:"","text-color":"grey",icon:"las la-times",dense:"","no-caps":"",size:"sm",class:"border-grey radius8"})]),_:1}),o(I,{onSubmit:l.beforeSubmit},{default:s(()=>[o(V,null,{default:s(()=>[h("div",z,p(e.$t("A 6 digit OTP will be sent via SMS to verify your mobile number")),1),h("div",B,[o(Q,{modelValue:r.phone_number,"onUpdate:modelValue":t[2]||(t[2]=n=>r.phone_number=n),dense:"",mask:"####################",color:e.$q.dark.mode?"grey300":"dark","bg-color":e.$q.dark.mode?"grey600":"white",borderless:"",size:"lg"},{prepend:s(()=>[o(E,{dense:"",modelValue:r.phone_prefix,"onUpdate:modelValue":t[1]||(t[1]=n=>r.phone_prefix=n),options:a.prefixes,behavior:"dialog","input-debounce":"700",style:{border:"none"},"emit-value":"",borderless:""},{"no-option":s(()=>[o(w,null,{default:s(()=>[o(C,{class:"text-grey"},{default:s(()=>[d(p(e.$t("No results")),1)]),_:1})]),_:1})]),_:1},8,["modelValue","options"])]),_:1},8,["modelValue","color","bg-color"])])]),_:1}),o(S,{vertical:"",align:"center",class:"q-pa-md"},{default:s(()=>[o(m,{disabled:l.hasChangePhone,loading:r.loading,type:"submit",label:e.$t("Save"),unelevated:"",color:l.hasChangePhone==!1?"primary":"grey-5","text-color":l.hasChangePhone==!1?"white":"dark","no-caps":"",class:"full-width",size:"lg"},null,8,["disabled","loading","label","color","text-color"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"]),o(f,{ref:"steps_verification",sent_message:r.sent_message,phone_prefix:r.phone_prefix,phone_number:r.phone_number,onAfterVerifycode:l.afterVerifycode},null,8,["sent_message","phone_prefix","phone_number","onAfterVerifycode"])],64)}var K=u($,[["render",N]]);export{K as default};
